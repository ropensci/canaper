<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CANAPE example • canaper</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="CANAPE example">
<meta property="og:description" content="canaper">
<meta property="og:image" content="https://docs.ropensci.org/canaper/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">canaper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/canape.html">CANAPE example</a>
    </li>
    <li>
      <a href="../articles/how-many-rand.html">How many randomizations?</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Parallel computing</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ropensci/canaper/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>CANAPE example</h1>
                        <h4 data-toc-skip class="author">Joel H.
Nitta</h4>
            
            <h4 data-toc-skip class="date">05 April, 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/canaper/blob/HEAD/vignettes/canape.Rmd" class="external-link"><code>vignettes/canape.Rmd</code></a></small>
      <div class="hidden name"><code>canape.Rmd</code></div>

    </div>

    
    
<p>CANAPE stands for “Categorical Analysis of Neo- And Paleo-Endemism”,
and provides insight into the evolutionary processes underlying endemism
<span class="citation">(Mishler et al. 2014)</span>. The idea is
basically that endemic regions may be so because either they contain
range-restricted parts of a phylogeny that have unusually long branch
lengths (paleoendemism), or unusually short branch lengths
(neoendemism), or a mixture of both. Paleoendemism may reflect old
lineages that have survived extinctions; neoendemism may reflect
recently speciated lineages that have not yet dispersed.</p>
<p>This vignette replicates the <a href="https://doi.org/10.1038/ncomms5473" class="external-link">analysis of Mishler et
al. 2014</a>, where CANAPE was originally defined.</p>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>Start by loading <code>canaper</code> and some other packages we will
use for this vignette:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/canaper">canaper</a></span><span class="op">)</span> <span class="co"># This package :)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span> <span class="co"># For parallel computing</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jabiru/tictoc" class="external-link">tictoc</a></span><span class="op">)</span> <span class="co"># For timing things</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span> <span class="co"># For composing multi-part plots</span></span>
<span><span class="co"># For data-wrangling and plotting</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dataset">Dataset<a class="anchor" aria-label="anchor" href="#dataset"></a>
</h2>
<p>The <code>canaper</code> package comes with the dataset used in <span class="citation">Mishler et al. (2014)</span>. Let’s load the data into
memory:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">acacia</span><span class="op">)</span></span></code></pre></div>
<p>The <code>acacia</code> dataset is a list including two items. The
first, <code>phy</code>, is a phylogeny of <em>Acacia</em> species in
Australia:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">acacia</span><span class="op">$</span><span class="va">phy</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Phylogenetic tree with 510 tips and 509 internal nodes.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Tip labels:</span></span>
<span><span class="co">#&gt;   Pararchidendron_pruinosum, Paraserianthes_lophantha, adinophylla, semicircinalis, aphanoclada, inaequilatera, ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rooted; includes branch lengths.</span></span></code></pre></div>
<p>The second, <code>comm</code>, is a community dataframe with species
as columns and rows as sites. The row names (sites) correspond to the
centroids of 50 x 50 km grid cells covering Australia. The community
matrix is too large to print out in its entirety, so we will just take a
look at the first 8 rows and columns<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">acacia</span><span class="op">$</span><span class="va">comm</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3037  508</span></span>
<span><span class="va">acacia</span><span class="op">$</span><span class="va">comm</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span></span>
<span><span class="co">#&gt;                   abbreviata acanthaster acanthoclada acinacea aciphylla acoma acradenia acrionastes</span></span>
<span><span class="co">#&gt; -1025000:-1825000          0           0            0        0         0     0         0           0</span></span>
<span><span class="co">#&gt; -1025000:-1875000          0           0            0        0         0     0         0           0</span></span>
<span><span class="co">#&gt; -1025000:-1925000          0           0            0        0         0     0         0           0</span></span>
<span><span class="co">#&gt; -1025000:-1975000          0           0            0        0         0     0         0           0</span></span>
<span><span class="co">#&gt; -1025000:-2025000          0           0            0        0         0     0         0           0</span></span>
<span><span class="co">#&gt; -1025000:-2075000          0           0            0        0         0     0         0           0</span></span>
<span><span class="co">#&gt; -1025000:-2125000          0           0            0        0         0     0         0           0</span></span>
<span><span class="co">#&gt; -1025000:-2225000          0           0            0        0         0     0         0           0</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="randomization-test">Randomization test<a class="anchor" aria-label="anchor" href="#randomization-test"></a>
</h2>
<p>There are many metrics that describe the phylogenetic diversity of
ecological communities. But how do we know if a given metric is
statistically significant? One way is with a randomization test. The
general process is:</p>
<ol style="list-style-type: decimal">
<li>Generate a set of random communities</li>
<li>Calculate the metric of interest for each random community</li>
<li>Compare the observed values to the random values</li>
</ol>
<p>Observed values that are in the extremes (e.g, the top or lower 5%
for a one-sided test, or either the top or bottom 2.5% for a two-sided
test) would be considered significantly more or less diverse than
random.</p>
<p>The main purpose of <code>canaper</code> is to perform these
randomization tests.</p>
<p><code>canaper</code> generates random communities using the <a href="https://CRAN.R-project.org/package=vegan" class="external-link"><code>vegan</code>
package</a>. There are a large number of pre-defined randomization
algorithms available in <code>vegan</code><a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>, as well as an option
to provide a user-defined algorithm. Selecting the appropriate algorithm
is not trivial, and can greatly influence results<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>. For details about the
pre-defined algorithms, see <code><a href="https://rdrr.io/pkg/vegan/man/commsim.html" class="external-link">vegan::commsim()</a></code>.</p>
<p>This example also demonstrates one of the strengths of
<code>canaper</code>: the ability to run randomizations in parallel<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>. This is
by far the most time-consuming part of CANAPE, since we have to repeat
the calculations many (e.g., hundreds or more) times across the
randomized communities to obtain reliable results. Here, we set the
number of iterations (<code>n_iterations</code>; i.e., the number of
swaps used to produce each randomized community) fairly high because
this community matrix is large and includes many zeros; thorough mixing
by swapping many times is required to completely randomize the
matrix.</p>
<p>We will use a low number of random communities (<code>n_reps</code>)
so things finish relatively quickly; you should consider increasing
<code>n_reps</code> for a “real” analysis<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>. We will use the
<code>curveball</code> randomization algorithm, which maintains species
richness and abundance patterns while randomizing species identity <span class="citation">(Strona et al. 2014)</span><a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set a parallel back-end, with 2 CPUs running simultaneously</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Uncomment this to show a progress bar when running cpr_rand_test()</span></span>
<span><span class="co"># progressr::handlers(global = TRUE) # nolint</span></span>
<span></span>
<span><span class="co"># Set a random number generator seed so we get the same results if this is</span></span>
<span><span class="co"># run again</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">071421</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html" class="external-link">tic</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># Set a timer</span></span>
<span><span class="co"># Run randomization test</span></span>
<span><span class="va">acacia_rand_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cpr_rand_test.html">cpr_rand_test</a></span><span class="op">(</span></span>
<span>  <span class="va">acacia</span><span class="op">$</span><span class="va">comm</span>, <span class="va">acacia</span><span class="op">$</span><span class="va">phy</span>,</span>
<span>  null_model <span class="op">=</span> <span class="st">"curveball"</span>,</span>
<span>  n_reps <span class="op">=</span> <span class="fl">20</span>, n_iterations <span class="op">=</span> <span class="fl">100000</span>,</span>
<span>  tbl_out <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Abundance data detected. Results will be the same as if using presence/absence data (no abundance weighting is used).</span></span>
<span><span class="co">#&gt; Warning: Dropping tips from the tree because they are not present in the community data: </span></span>
<span><span class="co">#&gt;  Pararchidendron_pruinosum, Paraserianthes_lophantha</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html" class="external-link">toc</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># See how long it took</span></span>
<span><span class="co">#&gt; 70.204 sec elapsed</span></span>
<span></span>
<span><span class="co"># Switch back to sequential (non-parallel) mode</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span></code></pre></div>
<p>Let’s take a peek at the output.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">acacia_rand_res</span></span>
<span><span class="co">#&gt; # A tibble: 3,037 × 55</span></span>
<span><span class="co">#&gt;    site       pd_obs pd_ra…¹ pd_ra…² pd_ob…³ pd_ob…⁴ pd_ob…⁵ pd_ob…⁶ pd_ob…⁷ pd_ob…⁸ pd_al…⁹ pd_al…˟ pd_al…˟ pd_al…˟ pd_al…˟ pd_al…˟ pd_al…˟ pd_al…˟ pd_al…˟ rpd_obs rpd_r…˟ rpd_r…˟ rpd_o…˟ rpd_o…˟ rpd_o…˟ rpd_o…˟ rpd_o…˟ rpd_o…˟  pe_obs pe_ra…˟ pe_ra…˟ pe_ob…˟ pe_ob…˟ pe_ob…˟ pe_ob…˟ pe_ob…˟ pe_ob…˟</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 -1025000… 0.0145   0.0207 0.00432 -1.46         1      19      20    0.05    0.95  0.0355  0.0414 0.00779  -0.753       5      14      20    0.25    0.7    0.407   0.514  0.129   -0.827       4      16      20    0.2     0.8  2.47e-5 6.14e-5 5.92e-5  -0.619       3      17      20    0.15    0.85</span></span>
<span><span class="co">#&gt;  2 -1025000… 0.0382   0.0522 0.00704 -1.99         0      20      20    0       1     0.0680  0.0883 0.00651  -3.10        0      20      20    0       1      0.561   0.595  0.0944  -0.358       9      11      20    0.45    0.55 1.44e-4 2.82e-4 1.86e-4  -0.738       5      15      20    0.25    0.75</span></span>
<span><span class="co">#&gt;  3 -1025000… 0.0378   0.0371 0.00535  0.130       12       8      20    0.6     0.4   0.0572  0.0631 0.00797  -0.743       2      17      20    0.1     0.85   0.661   0.593  0.0941   0.724      16       4      20    0.8     0.2  1.71e-4 2.42e-4 1.62e-4  -0.439       7      13      20    0.35    0.65</span></span>
<span><span class="co">#&gt;  4 -1025000… 0.0570   0.0606 0.00758 -0.480        6      14      20    0.3     0.7   0.0858  0.104  0.0105   -1.77        0      20      20    0       1      0.664   0.586  0.0913   0.863      17       3      20    0.85    0.15 5.30e-4 3.56e-4 2.33e-4   0.748      17       3      20    0.85    0.15</span></span>
<span><span class="co">#&gt;  5 -1025000… 0.0409   0.0423 0.00836 -0.176       11       9      20    0.55    0.45  0.0542  0.0713 0.00904  -1.89        0      19      20    0       0.95   0.753   0.596  0.102    1.55       19       1      20    0.95    0.05 1.25e-4 2.20e-4 1.31e-4  -0.728       6      14      20    0.3     0.7 </span></span>
<span><span class="co">#&gt;  6 -1025000… 0.00998  0.0102 0.00206 -0.0890      11       9      20    0.55    0.45  0.0276  0.0173 0.00742   1.39       18       2      20    0.9     0.1    0.361   0.695  0.337   -0.989       2      18      20    0.1     0.9  1.17e-5 3.86e-5 4.82e-5  -0.557       3      17      20    0.15    0.85</span></span>
<span><span class="co">#&gt;  7 -1025000… 0.0187   0.0230 0.00378 -1.14         3      17      20    0.15    0.85  0.0325  0.0390 0.00820  -0.782       2      16      20    0.1     0.8    0.575   0.619  0.189   -0.231      11       9      20    0.55    0.45 5.20e-5 9.07e-5 6.56e-5  -0.589       5      15      20    0.25    0.75</span></span>
<span><span class="co">#&gt;  8 -1025000… 0.0434   0.0516 0.00862 -0.955        4      16      20    0.2     0.8   0.0779  0.0956 0.00995  -1.78        1      19      20    0.05    0.95   0.557   0.544  0.100    0.125      12       8      20    0.6     0.4  4.32e-4 3.14e-4 1.24e-4   0.944      16       4      20    0.8     0.2 </span></span>
<span><span class="co">#&gt;  9 -1025000… 0.0111   0.0104 0.00172  0.418       17       3      20    0.85    0.15  0.0168  0.0211 0.00715  -0.607       6      14      20    0.3     0.7    0.662   0.558  0.227    0.461      16       4      20    0.8     0.2  2.73e-5 1.94e-5 1.53e-5   0.521      17       3      20    0.85    0.15</span></span>
<span><span class="co">#&gt; 10 -1025000… 0.0903   0.0896 0.0114   0.0601      13       7      20    0.65    0.35  0.115   0.143  0.00775  -3.51        0      20      20    0       1      0.783   0.629  0.0760   2.02       19       1      20    0.95    0.05 5.07e-4 5.76e-4 2.10e-4  -0.328      10      10      20    0.5     0.5 </span></span>
<span><span class="co">#&gt; # … with 3,027 more rows, 18 more variables: pe_alt_obs &lt;dbl&gt;, pe_alt_rand_mean &lt;dbl&gt;, pe_alt_rand_sd &lt;dbl&gt;, pe_alt_obs_z &lt;dbl&gt;, pe_alt_obs_c_upper &lt;dbl&gt;, pe_alt_obs_c_lower &lt;dbl&gt;, pe_alt_obs_q &lt;dbl&gt;, pe_alt_obs_p_upper &lt;dbl&gt;, pe_alt_obs_p_lower &lt;dbl&gt;, rpe_obs &lt;dbl&gt;, rpe_rand_mean &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   rpe_rand_sd &lt;dbl&gt;, rpe_obs_z &lt;dbl&gt;, rpe_obs_c_upper &lt;dbl&gt;, rpe_obs_c_lower &lt;dbl&gt;, rpe_obs_q &lt;dbl&gt;, rpe_obs_p_upper &lt;dbl&gt;, rpe_obs_p_lower &lt;dbl&gt;, and abbreviated variable names ¹​pd_rand_mean, ²​pd_rand_sd, ³​pd_obs_z, ⁴​pd_obs_c_upper, ⁵​pd_obs_c_lower, ⁶​pd_obs_q, ⁷​pd_obs_p_upper, ⁸​pd_obs_p_lower,</span></span>
<span><span class="co">#&gt; #   ⁹​pd_alt_obs, ˟​pd_alt_rand_mean, ˟​pd_alt_rand_sd, ˟​pd_alt_obs_z, ˟​pd_alt_obs_c_upper, ˟​pd_alt_obs_c_lower, ˟​pd_alt_obs_q, ˟​pd_alt_obs_p_upper, ˟​pd_alt_obs_p_lower, ˟​rpd_rand_mean, ˟​rpd_rand_sd, ˟​rpd_obs_z, ˟​rpd_obs_c_upper, ˟​rpd_obs_c_lower, ˟​rpd_obs_q, ˟​rpd_obs_p_upper, ˟​rpd_obs_p_lower,</span></span>
<span><span class="co">#&gt; #   ˟​pe_rand_mean, ˟​pe_rand_sd, ˟​pe_obs_z, ˟​pe_obs_c_upper, ˟​pe_obs_c_lower, ˟​pe_obs_q, ˟​pe_obs_p_upper, ˟​pe_obs_p_lower</span></span></code></pre></div>
<p><code><a href="../reference/cpr_rand_test.html">cpr_rand_test()</a></code> produces <strong>a lot</strong> of
columns. Here, <code>pd_obs</code> is the observed value of phylogenetic
diversity (PD). Other columns starting with <code>pd</code> refer to
aspects of the randomization: <code>pd_rand_mean</code> is the mean PD
across the random communities, <code>pd_rand_sd</code> is the standard
deviation of PD across the random communities, <code>pd_obs_z</code> is
the standard effect size of PD, etc.</p>
<p>For details about what each column means, see
<code><a href="../reference/cpr_rand_test.html">cpr_rand_test()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="classify-endemism">Classify endemism<a class="anchor" aria-label="anchor" href="#classify-endemism"></a>
</h2>
<p>The next step in CANAPE is to classify types of endemism. For a full
description, see <span class="citation">Mishler et al. (2014)</span>. In
short, this defines endemic regions based on combinations of the
<em>p</em>-values of phylogenetic endemism (PE; <code>pe_obs</code>) and
PE measured on an alternative tree with all branch lengths equal
(<code>pe_alt</code>). Here is a summary <a href="http://biodiverse-analysis-software.blogspot.com/2014/11/canape-categorical-analysis-of-palaeo.html" class="external-link">borrowed
from the biodiverse blog</a>, modified to use the variables as they are
defined in <code>canaper</code>:</p>
<ol style="list-style-type: decimal">
<li>If either <code>pe_obs</code> or <code>pe_alt_obs</code> are
significantly high then we look for paleo- or neo-endemism
<ol style="list-style-type: lower-alpha">
<li>If <code>rpe_obs</code> is significantly high then we have
palaeo-endemism</li>
<li>Else if <code>rpe_obs</code> is significantly low then we have
neo-endemism</li>
<li>Else we have mixed age endemism, in which case
<ol style="list-style-type: lower-roman">
<li>If both <code>pe_obs</code> and <code>pe_alt_obs</code> are highly
significant (<em>p</em> &lt; 0.01) then we have super endemism (high in
both paleo and neo)</li>
<li>Else we have mixed (some mixture of paleo, neo and nonendemic)</li>
</ol>
</li>
</ol>
</li>
<li>Else if neither <code>pe_obs</code> or <code>pe_alt_obs</code>are
significantly high then we have a non-endemic cell</li>
</ol>
<p><code><a href="../reference/cpr_classify_endem.html">cpr_classify_endem()</a></code> carries this out automatically on
the results from <code><a href="../reference/cpr_rand_test.html">cpr_rand_test()</a></code>, adding a factor called
<code>endem_type</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">acacia_canape</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cpr_classify_endem.html">cpr_classify_endem</a></span><span class="op">(</span><span class="va">acacia_rand_res</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">acacia_canape</span><span class="op">$</span><span class="va">endem_type</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           mixed             neo not significant           paleo           super </span></span>
<span><span class="co">#&gt;              99              12            2783              68              75</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="classify-significance">Classify significance<a class="anchor" aria-label="anchor" href="#classify-significance"></a>
</h2>
<p>A similar function to <code><a href="../reference/cpr_classify_endem.html">cpr_classify_endem()</a></code> is available
to classify significance of the randomization test,
<code><a href="../reference/cpr_classify_signif.html">cpr_classify_signif()</a></code>. Note that both of these take a
<code>data.frame</code> as input and return a <code>data.frame</code> as
output, so they are “pipe-friendly”. The second argument of
<code><a href="../reference/cpr_classify_signif.html">cpr_classify_signif()</a></code> is the name of the biodiversity
metric that you want to classify. This will add a column
<code>*_signif</code> with the significance relative to the random
distribution for that metric. For example,
<code>cpr_classify_signif(df, "pd")</code> will add the
<code>pd_signif</code> column to <code>df</code>.</p>
<p>We can chain them together as follows:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">acacia_canape</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/cpr_classify_endem.html">cpr_classify_endem</a></span><span class="op">(</span><span class="va">acacia_rand_res</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/cpr_classify_signif.html">cpr_classify_signif</a></span><span class="op">(</span><span class="st">"pd"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/cpr_classify_signif.html">cpr_classify_signif</a></span><span class="op">(</span><span class="st">"rpd"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/cpr_classify_signif.html">cpr_classify_signif</a></span><span class="op">(</span><span class="st">"pe"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/cpr_classify_signif.html">cpr_classify_signif</a></span><span class="op">(</span><span class="st">"rpe"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Take a look at one of the significance classifications:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">acacia_canape</span><span class="op">$</span><span class="va">pd_signif</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          &lt; 0.01          &gt; 0.99 not significant </span></span>
<span><span class="co">#&gt;             582              91            2364</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualize-results">Visualize results<a class="anchor" aria-label="anchor" href="#visualize-results"></a>
</h2>
<p>With the randomizations and classification steps taken care of, we
can now visualize the results to see how they match up with those of
<span class="citation">Mishler et al. (2014)</span>.</p>
<p>Note that the results will not be identical because we have used a
different randomization algorithm from the paper and because of
stochasticity in the random values, as well as fewer replicates for the
randomization test.</p>
<p>Here is Figure 2, showing the results of the randomization test for
PE, RPE, PE, and RPE:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fist do some data wrangling to make the results easier to plot</span></span>
<span><span class="co"># (add lat/long columns)</span></span>
<span><span class="va">acacia_canape</span> <span class="op">&lt;-</span> <span class="va">acacia_canape</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">separate</span><span class="op">(</span><span class="va">site</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"long"</span>, <span class="st">"lat"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">":"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">long</span>, <span class="va">lat</span><span class="op">)</span>, <span class="va">parse_number</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_update</a></span><span class="op">(</span></span>
<span>  panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>,</span>
<span>  panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey60"</span><span class="op">)</span>,</span>
<span>  panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">acacia_canape</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span>, fill <span class="op">=</span> <span class="va">pd_signif</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># cpr_signif_cols_2 is a CVD-friendly color palette in canaper</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">cpr_signif_cols_2</span>, name <span class="op">=</span> <span class="st">"Phylogenetic diversity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title.position <span class="op">=</span> <span class="st">"top"</span>, label.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">acacia_canape</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span>, fill <span class="op">=</span> <span class="va">rpd_signif</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="va">cpr_signif_cols_2</span>, name <span class="op">=</span> <span class="st">"Relative phylogenetic diversity"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title.position <span class="op">=</span> <span class="st">"top"</span>, label.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">acacia_canape</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span>, fill <span class="op">=</span> <span class="va">pe_signif</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">cpr_signif_cols_2</span>, name <span class="op">=</span> <span class="st">"Phylogenetic endemism"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title.position <span class="op">=</span> <span class="st">"top"</span>, label.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">acacia_canape</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span>, fill <span class="op">=</span> <span class="va">rpe_signif</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="va">cpr_signif_cols_2</span>, name <span class="op">=</span> <span class="st">"Relative phylogenetic endemism"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title.position <span class="op">=</span> <span class="st">"top"</span>, label.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">+</span> <span class="va">c</span> <span class="op">+</span> <span class="va">d</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"a"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="vigfig-mishler2014-fig2-1.png" alt=""><p class="caption">Significance results</p>
</div>
<p>And here is Figure 3, showing the results of CANAPE:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">acacia_canape</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span>, fill <span class="op">=</span> <span class="va">endem_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># cpr_endem_cols_4 is a CVD-friendly color palette in canaper</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">cpr_endem_cols_4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title.position <span class="op">=</span> <span class="st">"top"</span>, label.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">acacia_canape</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pe_alt_obs</span>, y <span class="op">=</span> <span class="va">pe_obs</span>, color <span class="op">=</span> <span class="va">endem_type</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"darkgrey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">cpr_endem_cols_4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Phylogenetic endemism on comparison tree"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Phylogenetic endemism on actual tree"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"a"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="vigfig-mishler2014-fig3-1.png" alt=""><p class="caption">CANAPE results</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Mishler2014" class="csl-entry">
Mishler, Brent D, Nunzio Knerr, Carlos E. González-Orozco, Andrew H.
Thornhill, Shawn W. Laffan, and Joseph T. Miller. 2014.
<span>“Phylogenetic Measures of Biodiversity and Neo- and Paleo-Endemism
in Australian Acacia.”</span> <em>Nature Communications</em> 5: 4473. <a href="https://doi.org/10.1038/ncomms5473" class="external-link">https://doi.org/10.1038/ncomms5473</a>.
</div>
<div id="ref-Strona2014" class="csl-entry">
Strona, Giovanni, Domenico Nappo, Francesco Boccacci, Simone Fattorini,
and Jesus San-Miguel-Ayanz. 2014. <span>“A Fast and Unbiased Procedure
to Randomize Ecological Binary Matrices with Fixed Row and Column
Totals.”</span> <em>Nature Communications</em> 5 (1): 4114. <a href="https://doi.org/10.1038/ncomms5114" class="external-link">https://doi.org/10.1038/ncomms5114</a>.
</div>
<div id="ref-Strona2018" class="csl-entry">
Strona, Giovanni, Werner Ulrich, and Nicholas J. Gotelli. 2018.
<span>“Bi‐dimensional Null Model Analysis of Presence‐absence Binary
Matrices.”</span> <em>Ecology</em> 99 (1): 103–15. <a href="https://doi.org/10.1002/ecy.2043" class="external-link">https://doi.org/10.1002/ecy.2043</a>.
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>You might think the dataset is all zeros, but that is
not the case. It is just very sparse.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>31 as of <code>vegan</code> v2.6.4, though not all may
be applicable.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>For a good review of randomization algorithms and their
implications for analysis results, see <span class="citation">Strona,
Ulrich, and Gotelli (2018)</span><a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>For more information on how and when to use parallel
computing in <code>canaper</code>, <a href="https://docs.ropensci.org/canaper/articles/parallel.html">see the
“Parallel computing” vignette</a><a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>For more information on setting the appropriate number
of iterations and replicates, <a href="https://docs.ropensci.org/canaper/articles/how-many-rand.html">see
the “How many randomizations?” vignette</a>.<a href="#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p><code>curveball</code> is similar to <code>swap</code>
but runs much faster so I chose it for this large dataset.<a href="#fnref6" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Joel H. Nitta.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
